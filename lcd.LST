C51 COMPILER V7.01  LCD                                                                    06/07/2006 19:12:53 PAGE 1   


C51 COMPILER V7.01, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN lcd.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE lcd.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          #include"lcd.h"
   2           
   3           /*///////////////////////////////////////////////////////////////////////
   4           函数名：  液晶数据发送delay
   5           功能：    
   6           返回值：  
   7           注意：         无
   8          
   9          //////////////////////////////////////////////////////////////////////*/
  10          
  11            delay(uchar n)
  12                  {uchar f,m;
  13   1              for(m=n;m>0;m--)
  14   1         //for(n=15;n>0;n++)
  15   1              for(f=248;f>0;f--)
  16   1              {}      }
  17          
  18          
  19          
  20          /*///////////////////////////////////////////////////////////////////////
  21           函数名： 模拟串行数据发送函数
  22           功能：   将要发送的数据转成串行数据 
  23           返回值：  
  24           注意：   这里使用164芯片转换
  25          
  26          //////////////////////////////////////////////////////////////////////*/
  27          /*-------------------------------------------------------------------------------------------------*/   
  28           corr(uchar dat)  //164使用共阴代码
  29          {uchar ADS,n;
  30   1       ADS=dat;
  31   1       for(n=8;n>0;n--)
  32   1        {
  33   2         TD=0;
  34   2         RDat=ADS&0x80;      
  35   2         TD=1;
  36   2         ADS=ADS<<1;  
  37   2        }
  38   1       }
  39          
  40           /*///////////////////////////////////////////////////////////////////////
  41           函数名：   液晶显示器的命令发送函数
  42           功能：    将要显示的字符在液晶上的地址发到液晶显示器还有显示的初此化数据
  43           返回值：  
  44           注意：
  45          
  46          //////////////////////////////////////////////////////////////////////*/
  47            lcd_com(unsigned char a)
  48           {  E=1;
  49   1          RS=0;
  50   1              WR1=0;
  51   1              corr(a);
  52   1          /*f_buzy(); */
  53   1          delay(1);
  54   1              E=0;
  55   1       }
C51 COMPILER V7.01  LCD                                                                    06/07/2006 19:12:53 PAGE 2   

  56          /*///////////////////////////////////////////////////////////////////////
  57           函数名：液晶显示器的数据发送函数  
  58           功能：  将要显示的字符的ASCII码发到液晶模块  
  59           返回值：无  
  60           注意:   无
  61          
  62          //////////////////////////////////////////////////////////////////////*/
  63             lcd_dat(unsigned char b)
  64            {  E=1;
  65   1           RS=1;
  66   1               WR1=0;
  67   1               corr(b);
  68   1           /*f_buzy(); */
  69   1           delay(1);
  70   1               E=0;
  71   1        }
  72          /*///////////////////////////////////////////////////////////////////////
  73           函数名：  液晶显示数据缓冲函数
  74           功能：    将要显示的数据的首地址和要显示的地址缓冲
  75           返回值：  无
  76           注意：    对于字符型显示器它第一行的首地址是0x80第二行是0xc0
  77          
  78          //////////////////////////////////////////////////////////////////////*/
  79          lcd_dis(uchar k[],char r) 
  80          {char n;
  81   1      lcd_com(r);
  82   1      //delay(1);          
  83   1      for(n=0;k[n]!=0x00;n++)
  84   1      {lcd_dat(k[n]);
  85   2      }
  86   1      
  87   1      }
  88          
  89          
  90          
  91          /*///////////////////////////////////////////////////////////////////////
  92           函数名：  液晶显示初此化函数
  93           功能：    初此化液晶数据
  94           返回值：  无
  95           注意：
  96          
  97          //////////////////////////////////////////////////////////////////////*/
  98            lcdinit() 
  99             {
 100   1          lcd_com(0x0f);   //显示开关控制，开显示，开光标，闪烁?
 101   1              lcd_com(0x38);   //8位数据总线，两行显示，5X7点阵
 102   1              lcd_com(0x01);   //清屏
 103   1          delay(1);
 104   1              lcd_com(0x06);   //AC自动加1，显示不动  
 105   1              
 106   1              }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    124    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V7.01  LCD                                                                    06/07/2006 19:12:53 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
